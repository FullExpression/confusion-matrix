<div class="confusion-matrix-wrapper" *ngIf="_confusionMatrix" #confusionMatrix [style.transform]="scale"
    [@inOutAnimation]>
    <div class="title">
        <div>
            <span type='text' (focusout)="changeTitle($event);" [attr.contenteditable]="editionMode">{{title}}</span>
        </div>
    </div>
    <div class="confusion-matrix">
        <div class="rows-label">
            <div class="row-label" *ngFor="let label of _confusionMatrix.labels; let i = index">
                <span class="text" type='text' (focusout)="changeLabel($event, i);"
                    [attr.contenteditable]="editionMode">{{label}}</span>
                <span *ngIf="editionMode" class='add' (click)="add(i)" [@rowsAddDeleteAnimation]>➕</span>
                <span *ngIf="editionMode" class="remove" (click)="removeLabel(_confusionMatrix.labels[i])"
                    [@rowsAddDeleteAnimation]>❌</span>

            </div>
        </div>
        <div class="rows" #rows>
            <div class="row" *ngFor="let label of _confusionMatrix.labels; let rowIndex = index" [@removeAddColumns]>
                <div class="columns">
                    <div class="column" [style.background-color]="getColor(column)"
                        *ngFor="let column of _confusionMatrixTransposed.matrix[rowIndex]; let columnIndex = index"
                        [@removeAddLine]>

                        <div class='column-value'>
                            <span type='text' (focusout)="matrixValueChange($event, columnIndex , rowIndex);"
                                [attr.contenteditable]="editionMode">{{column | number:
                                roundRules}}</span>
                        </div>
                    </div>

                    <div class="row-label">
                        <span *ngIf="editionMode" class='add' (click)="add(rowIndex)"
                            [@columnsAddDeleteAnimation]>➕</span>
                        <span *ngIf="editionMode" class="remove"
                            (click)="removeLabel(_confusionMatrix.labels[rowIndex])"
                            [@columnsAddDeleteAnimation]>❌</span>
                        <span class="text" type='text' (focusout)="changeLabel($event, rowIndex);"
                            [attr.contenteditable]="editionMode">{{label}}</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="intensity-bar" [style.height.px]="intensityHeight">
            <div class="bar" [ngStyle]="getGradientBackground()"></div>
            <div class="measure-wrapper">
                <div class="measure" *ngFor="let item of _levelsColor; let i = index">
                    <div class="dash"></div>
                    <div class="value">{{ getIntensityNumber(i) | number: roundRules }}</div>
                </div>
            </div>
        </div>
        <div class="tools" (click)="showConfigurationPanel = true;" [class.edition-mode]="editionMode">
            ⚙️ Tools
        </div>
        <div class="undo-redo" [class.edition-mode]="editionMode">
            <span class="redo" [class.available]="_confusionMatrix.isUndoAvailable()" (click)="undo()">↪️</span>
            <span class="undo" [class.available]="_confusionMatrix.isRedoAvailable()" (click)="redo()">↩️</span>
        </div>
    </div>
</div>
<div class="configurations-panel" *ngIf="showConfigurationPanel" [@outAnimation]>
    <configurations [(visible)]="showConfigurationPanel" (optionChange)="optionChanged($event)"
        [editionToggle]="editionMode">
    </configurations>
</div>